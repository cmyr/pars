# pars â€“ derive simple `FromStr` implementations

**status: experimental**

This is an attempt to automate the generation of `FromStr`-like behaviour for
custom structs (and eventually maybe enums).

Structure can be described using either a custom _simple_ format language, or
with regular expressions.

## Format strings

The best way to use Pars is with the built-in format notation. This uses
`#{}` to indicate the presence of a field. Fields can be named or unnamed;
if they are unnamed they will be applied in the order they are declared
in the target struct.

This format langauge is essentially a way of indicating regions of the input
format that delineate fields. As such it is **very** limited:

- All fields must be separated by non-field characters (`"#{name}#{age}"`
will not compile)
- input must have an unambiguous structure. For instance,
("names: Colin, Smriti, Casimir blue" cannot be parsed by
`"names: #{names} #{color}"`, because the space after `#{names}` will
match the space after 'Colin,'.

Pars is intended to be **lightweight**, **barebones**, and **fast**. In many
use cases, the code generated by Pars will be as fast as when written by
hand.

## Examples:

### using format template

```rust
use pars::ParsFromStr;

#[pars::fmt("Rect((#{x}, #{y}), (#{width}, #{height}))")]
struct Rect {
    x: u32,
    y: u32,
    width: u32,
    height: u32,
}

let Rect { x, y, width, height } = Rect::pars_from_str("Rect((0, 3), (20, 22))").unwrap();
assert_eq!((x, y, width, height), (0, 3, 20, 22));
```

### Fields out of order:

```rust
#[pars::fmt("(#{x}, #{y}): #{name}")]
struct NamedPosition {
    name: String,
    x: f64,
    y: f64,
}

let NamedPosition { name, x, y } = NamedPosition::pars_from_str("(42.4,
-555.111): Home");
assert_eq!((name.as_str(), x, y), ("Home", 42.4, -555.111));
```

### Tuple struct:

```
 use pars::ParsFromStr;

#[pars::fmt("(#{x}, #{y})")] // alternatively: #[pars::fmt("(#{_}, #{_})")]
struct Point(f64, f64);

let example = "(42.4, -5)";
let point = Point::pars_from_str(example).unwrap();
assert_eq!((point.0, point.1), (42.4, -5));
```

### Regex:

```
use pars::ParsFromStr;

let sample_input = ["colin daniels 55", "casimir faithful ndolo 4"];

#[pars::re(r"([\w ]+) (\d+)")]
struct Person {
    name: String,
    rank: u32,
}

let Person { name, rank } = Person::pars_from_str(&sample_input[0]).unwrap();
assert_eq!((name.as_str(), rank), ("colin daniels", 55));

let Person { name, rank } = Person::pars_from_str(&sample_input[1]).unwrap();
assert_eq!((name.as_str(), rank), ("casimir faithful ndolo", 4));
```
